import{World as e}from"../js-libs/ecsy.module.js";import{GameSystem as t,TransformSystem as n,CameraSystem as s,Transform as o,Scene as a,MeshSystem as c,LightSystem as r,MaterialSystem as i,InputSystem as p,Camera as m,Mesh as u,MeshTypes as l,Material as d,Light as g,Input as w}from"../js-libs/ecsy-babylon.module.js";class y extends e{constructor(){super()}get entities(){return this.entityManager._entities}get systems(){return this.systemManager._systems}get gameSystem(){return this.getSystem(t)}static instance(){return this._game||(this._game=new y),this._game}start(e,o){return this.registerSystem(t).registerSystem(n).registerSystem(s),o.forEach(e=>this.registerSystem(e)),this.gameSystem.start(e),this}createEntity(){return super.createEntity().addComponent(o)}createScene(e){return super.createEntity().addComponent(a,{color:e})}showDebugger(){this.gameSystem.activeScene.debugLayer.show()}}const h=y.instance();h.start(document.getElementById("renderCanvas"),[c,r,i,p]);const b=h.createScene({clear:"#9A7D0AFF"});h.createEntity().addComponent(m,{scene:b}).getMutableComponent(o).position.y=1.7;const C=h.createEntity().addComponent(u,{scene:b,type:l.Sphere}).addComponent(d,{scene:b,color:{diffuse:"#E74C3C"}});C.getMutableComponent(o).position.y=.5,C.getMutableComponent(o).position.z=2,h.createEntity().addComponent(g,{scene:b}).getMutableComponent(g).direction.y=1,h.createEntity().addComponent(u,{scene:b,type:l.Ground,options:{width:10,height:10}}).addComponent(d,{scene:b,texture:{diffuse:{url:"https://i0.wp.com/www.sharetextures.com/wp-content/uploads/2018/09/PBR-Leopard_skin-diffuse-.jpg?ssl=1",uScale:5,vScale:5},bump:{url:"https://i1.wp.com/www.sharetextures.com/wp-content/uploads/2018/09/PBR-Leopard_skin-normal-.jpg?ssl=1",uScale:5,vScale:5},specular:{url:"https://i2.wp.com/www.sharetextures.com/wp-content/uploads/2018/09/PBR-Leopard_skin-specular-.jpg?ssl=1",uScale:5,vScale:5}}}),h.createEntity().addComponent(w,{scene:b,onKey:function(e,t){if(t)switch(e){case"z":case"Z":h.gameSystem.switchScene(S);break;case"w":case"W":C.getMutableComponent(o).position.z+=.1;break;case"a":case"A":C.getMutableComponent(o).position.x-=.1;break;case"s":case"S":C.getMutableComponent(o).position.z-=.1;break;case"d":case"D":C.getMutableComponent(o).position.x+=.1}}});const S=h.createScene({clear:"#4D5656FF"});h.createEntity().addComponent(m,{scene:S,pointerLock:!0}).getMutableComponent(o).position.y=1.7;const f=h.createEntity().addComponent(u,{scene:S}).addComponent(d,{scene:S,color:{diffuse:"#3498DB"}});f.getMutableComponent(o).position.y=.5,f.getMutableComponent(o).position.z=2,h.createEntity().addComponent(g,{scene:S}).getMutableComponent(g).direction.y=1,h.createEntity().addComponent(u,{scene:S,type:l.Ground,options:{width:10,height:10}}).addComponent(d,{scene:S,texture:{diffuse:{url:"https://i0.wp.com/www.sharetextures.com/wp-content/uploads/2018/09/zebra_skin.jpg-diffuse.jpg?ssl=1",uScale:5,vScale:5},bump:{url:"https://i2.wp.com/www.sharetextures.com/wp-content/uploads/2018/09/zebra_skin.jpg-normal.jpg?ssl=1",uScale:5,vScale:5},specular:{url:"https://i1.wp.com/www.sharetextures.com/wp-content/uploads/2018/09/zebra_skin.jpg-specular.jpg?ssl=1",uScale:5,vScale:5}}}),h.createEntity().addComponent(w,{scene:S,onKey:function(e,t){if(t)switch(e){case"t":case"T":h.gameSystem.switchScene(b);break;case"w":case"W":f.getMutableComponent(o).position.z+=.1;break;case"a":case"A":f.getMutableComponent(o).position.x-=.1;break;case"s":case"S":f.getMutableComponent(o).position.z-=.1;break;case"d":case"D":f.getMutableComponent(o).position.x+=.1}}}),window.game=h;
